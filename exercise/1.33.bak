#lang planet neil/sicp
; 通过引入一个过滤器(filter) 来处理被组合的项，完成accumulate的列一般版本
; 在计算的过程中只组合满足过滤条件的项
; a) 求出区间 a b 内所有素数和
; b) 求小于 n 的所有与 n 素素的正整数的 乘积

(define (filtered-accumulate filter combiner null-vlaue term a next b)
  (if (> a b)
      null-value
      (if (filter a)
          (combiner (term a)
                    (filtered-accumulate filter combiner null-value term (next a) b))
          (combiner null-value
                    (filtered-accumulate filter combiner null-value term (next a) b)))))

